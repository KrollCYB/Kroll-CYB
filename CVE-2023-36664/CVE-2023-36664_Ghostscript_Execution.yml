title: Execution via Ghostscript
id: feae1ee9-08f5-4621-af38-ad1785dab57b
status: production
description: CVE-2023-36664 affecting Ghostscript prior to version 10.01.2 leads to code execution. This detects suspicious child proccess spawning from Ghostscript.
references:
    - https://www.kroll.com
author: Povilas Valantiejus & George Glass (Kroll)
date: 2023/07/11
tags:
    - attack.execution
    - attack.t1204.002
logsource:
    product: windows
    category: process_creation
detection:
    selection_gs_binaries:
        ParentImage|endswith:
            - "\gswin64c.exe"
            - "\GSWIN32C.EXE"
            - "\gswin32.exe"
            - "\gswin64.exe"
    filter_gs_fps:
        Image:
        - 'werfault.exe'
        - 'wermgr.exe'
        - 'conhost.exe'
    condition: selection_gs_binaries and not filter_*
falsepositives:
     - Windows error messages and updates to Ghostscipt, these are filered in this detection.
level: high

